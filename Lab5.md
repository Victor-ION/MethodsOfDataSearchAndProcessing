Лабораторна робота № 5. Зчитування даних з WEB.
================

В цій лабораторній роботі необхідно зчитати WEB сторінку з сайту
IMDB.com зі 100 фільмами 2017 року виходу за посиланням
«<http://www.imdb.com/search/title?count=100&release_date=2017,2017&title_type=feature>».
Необхідно створити data.frame «movies» з наступними даними: номер фільму
(rank\_data), назва фільму (title\_data), тривалість (runtime\_data).
Для виконання лабораторної рекомендується використати бібліотеку
«rvest». CSS селектори для зчитування необхідних даних: rank\_data:
«.text-primary», title\_data: «.lister-item-header a», runtime\_data:
«.text-muted .runtime». Для зчитування url використовується функція
read\_html, для зчитування даних по CSS селектору – html\_nodes і для
перетворення зчитаних html даних в текст - html\_text. Рекомендується
перетворити rank\_data та runtime\_data з тексту в числові значення. При
формуванні дата фрейму функцією data.frame рекомендується використати
параметр «stringsAsFactors = FALSE». В результаті виконання
лабораторної роботи необхідно відповісти на запитання нижче.

``` r
library(xml2)
library(rvest)

html = read_html("http://www.imdb.com/search/title?count=100&release_date=2017,2017&title_type=feature")
rank_data <- as.numeric(html_text(html_nodes(html, '.text-primary')))
title_data <- html_text(html_nodes(html, '.lister-item-header a'))

# Firstly, we need to treat empty runtime cases. Current approach is to get list of outer objects and check for each case whether we have runtime or not, for the last case we should add NA to the result list, not just skip it:)
content_data <- html_nodes(html, '.lister-item-content')
runtime_data_raw <- character(0)
for (content_node in content_data) {
  extracted = html_text(html_node(content_node, '.text-muted .runtime'))
  if (length(extracted) == 0) {
    runtime_data_raw <- c(runtime_data_raw, NA)
  } else {
    runtime_data_raw <- c(runtime_data_raw, extracted)
  }
}
# old approach - not working for empty runtime cases
#runtime_data_raw <- html_text(html_nodes(html, '.text-muted .runtime'))

runtime_data <- as.numeric(gsub(" min", "", runtime_data_raw)) 

movies <- data.frame(Rank = rank_data, Title = title_data, Runtime = runtime_data, stringsAsFactors = FALSE)
movies
```

    ##     Rank                                    Title Runtime
    ## 1      1               Джуманджі: Поклик джунглів     119
    ## 2      2  Зоряні війни: Епізод 8 - Останні Джедаї     152
    ## 3      3                            Тор: Рагнарок     130
    ## 4      4                                     Воно     135
    ## 5      5                               Диво-Жiнка     141
    ## 6      6                      Рятувальники Малiбу     116
    ## 7      7             Той, хто біжить по лезу 2049     164
    ## 8      8                       A Christmas Prince      92
    ## 9      9                     Найвеличнiший шоумен     105
    ## 10    10                     Call Me by Your Name     132
    ## 11    11                        Пострiл в безодню     121
    ## 12    12                     Воно приходить уночi      91
    ## 13    13                               Ледi Бьорд      94
    ## 14    14                      Лiга справедливостi     120
    ## 15    15             Вбивство в Схiдному експресi     114
    ## 16    16                     Дуже поганi матусi 2     104
    ## 17    17                                   Пастка     104
    ## 18    18                               Форма води     123
    ## 19    19                          Логан: Росомаха     137
    ## 20    20                                  Дюнкерк     106
    ## 21    21                           Секретне досьє     116
    ## 22    22                                  Я, Тоня     119
    ## 23    23                   Історії сім'ї Майровіц     112
    ## 24    24 Пірати Карибського моря: Помста Салазара     129
    ## 25    25                               Гарнi часи     101
    ## 26    26                     Красуня i Чудовисько     129
    ## 27    27               Король Артур: Легенда меча     126
    ## 28    28           Валерiан i мiсто тисячi планет     137
    ## 29    29                      Вартові Галактики 2     136
    ## 30    30                  Kingsman: Золоте кiльце     141
    ## 31    31                                     Коко     105
    ## 32    32                       Анна й Апокалiпсис      93
    ## 33    33                                На драйві     113
    ## 34    34       Три білборди під Еббінґом, Міссурі     115
    ## 35    35                            Three Christs     117
    ## 36    36                                     Диво     113
    ## 37    37          Людина-павук: Повернення додому     133
    ## 38    38                            Та сама зiрка      86
    ## 39    39                  Тебе нiколи тут не було      89
    ## 40    40                                    Мати!     121
    ## 41    41                             Удача Лохана     118
    ## 42    42                           The Babysitter      85
    ## 43    43                                Гра Моллi     140
    ## 44    44            Баррi Сiл: Король контрабанди     115
    ## 45    45                               Джон Уiк 2     122
    ## 46    46             Трансформери: Останнiй лицар     154
    ## 47    47                           Чужий: Заповiт     122
    ## 48    48                           Sweet Virginia      93
    ## 49    49                     Тiлоохоронець кiлера     118
    ## 50    50                          Усi грошi свiту     132
    ## 51    51                      Конг: Острiв черепа     118
    ## 52    52                                Зменшення     135
    ## 53    53                               Темна вежа      95
    ## 54    54                     Щасливий день смертi      96
    ## 55    55                     Американський убивця     112
    ## 56    56                           Only the Brave     134
    ## 57    57                        Хто в домi тато 2     100
    ## 58    58                             Вітряна ріка     107
    ## 59    59                                     Окча     120
    ## 60    60         Калiфорнiйський дорожнiй патруль     100
    ## 61    61                           Примарна нитка     130
    ## 62    62                                    Мумiя     110
    ## 63    63                             Гра Джералда     103
    ## 64    64                Вбивство священного оленя     121
    ## 65    65                          The Current War     102
    ## 66    66                         Атомна Блондинка     115
    ## 67    67                                  Яскравi     117
    ## 68    68                                 Геошторм     109
    ## 69    69                               Темнi часи     125
    ## 70    70               Christmas in the Heartland     112
    ## 71    71                Saban's Могутнi рейнджери     124
    ## 72    72              Людина, яка винайшла Рiздво     104
    ## 73    73              П'ятдесят вiдтiнкiв темряви     118
    ## 74    74                             Горе-творець     104
    ## 75    75                                 Форсаж 8     136
    ## 76    76                          Pitch Perfect 3      93
    ## 77    77                        Рiздвяна спадщина     104
    ## 78    78                              The Snowman     119
    ## 79    79                    Вiйна за планету мавп     140
    ## 80    80                                  Метелик     133
    ## 81    81                         Проект 'Флорида'     111
    ## 82    82                               Обдарована     101
    ## 83    83                           Привид у броні     107
    ## 84    84                                Time Trap      87
    ## 85    85                                   Вороги     134
    ## 86    86                        1+1: Нова iсторiя     126
    ## 87    87                                    Життя     104
    ## 88    88                                   Ритуал      94
    ## 89    89                           Смерть Сталiна     107
    ## 90    90                                  Тачки 3     102
    ## 91    91                  Розваги дорослих дiвчат     101
    ## 92    92                                  Квадрат     151
    ## 93    93                               Girls Trip     122
    ## 94    94                             Disobedience     114
    ## 95    95                               Сiм сестер     123
    ## 96    96                        Кохання - хвороба     120
    ## 97    97                                    Сфера     110
    ## 98    98                            Гора мiж нами     112
    ## 99    99                                Анабель 2     109
    ## 100  100                              Коматозники     109

## Task 1.

##### Виведіть перші 6 назв фільмів дата фрейму.

``` r
movies[1:6, "Title"]
```

    ## [1] "Джуманджі: Поклик джунглів"             
    ## [2] "Зоряні війни: Епізод 8 - Останні Джедаї"
    ## [3] "Тор: Рагнарок"                          
    ## [4] "Воно"                                   
    ## [5] "Диво-Жiнка"                             
    ## [6] "Рятувальники Малiбу"

## Task 2.

##### Виведіть всі назви фільмів с тривалістю більше 120 хв.

``` r
movies[which(movies$Runtime > 120), "Title"]
```

    ##  [1] "Зоряні війни: Епізод 8 - Останні Джедаї" 
    ##  [2] "Тор: Рагнарок"                           
    ##  [3] "Воно"                                    
    ##  [4] "Диво-Жiнка"                              
    ##  [5] "Той, хто біжить по лезу 2049"            
    ##  [6] "Call Me by Your Name"                    
    ##  [7] "Пострiл в безодню"                       
    ##  [8] "Форма води"                              
    ##  [9] "Логан: Росомаха"                         
    ## [10] "Пірати Карибського моря: Помста Салазара"
    ## [11] "Красуня i Чудовисько"                    
    ## [12] "Король Артур: Легенда меча"              
    ## [13] "Валерiан i мiсто тисячi планет"          
    ## [14] "Вартові Галактики 2"                     
    ## [15] "Kingsman: Золоте кiльце"                 
    ## [16] "Людина-павук: Повернення додому"         
    ## [17] "Мати!"                                   
    ## [18] "Гра Моллi"                               
    ## [19] "Джон Уiк 2"                              
    ## [20] "Трансформери: Останнiй лицар"            
    ## [21] "Чужий: Заповiт"                          
    ## [22] "Усi грошi свiту"                         
    ## [23] "Зменшення"                               
    ## [24] "Only the Brave"                          
    ## [25] "Примарна нитка"                          
    ## [26] "Вбивство священного оленя"               
    ## [27] "Темнi часи"                              
    ## [28] "Saban's Могутнi рейнджери"               
    ## [29] "Форсаж 8"                                
    ## [30] "Вiйна за планету мавп"                   
    ## [31] "Метелик"                                 
    ## [32] "Вороги"                                  
    ## [33] "1+1: Нова iсторiя"                       
    ## [34] "Квадрат"                                 
    ## [35] "Girls Trip"                              
    ## [36] "Сiм сестер"

## TASK 3.

##### Скільки фільмів мають тривалість менше 100 хв.

``` r
nrow(movies[which(movies$Runtime < 100),])
```

    ## [1] 13
